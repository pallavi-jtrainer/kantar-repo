package com.edforce.sampleproject.service;

import java.util.List;
import java.util.Optional;

import org.springframework.stereotype.Service;

import com.edforce.sampleproject.entity.Student;
import com.edforce.sampleproject.exception.ResourceNotFoundException;
import com.edforce.sampleproject.exception.WrongInputException;
import com.edforce.sampleproject.repository.StudentRepository;

import jakarta.transaction.Transactional;

@Service
public class StudentService {
	
	private final StudentRepository repo;
	
	public StudentService(StudentRepository repo) {
		this.repo = repo;
	}
	
	public Student createStudent(Student s) {
		return repo.save(s);
	}
	
	public List<Student> listAllStudents() {
		return repo.findAll();
	}
	
	@Transactional
	public String updateCourse(Long id, Long course) {
		String str = "Unable to update course";
		
		if(course == null) {
			throw new WrongInputException("Wrong input");
		}
		
		int res = repo.updateCourseId(id, course);
		
		if(res > 0) {
			str = "Course id updated";
		}
		
		return str;
	}
	
	public Optional<Student> getStudentData(Long id) throws ResourceNotFoundException {
//		Optional<Student> s = Optional.of(repo.findByStudentId(id).get());
////				.orElseThrow(() -> new RuntimeException("Student Not Found")
////				);
//		
//		return s;
		
		return Optional.of(repo.findByStudentId(id)
				.orElseThrow(() -> new ResourceNotFoundException("Student not found")));
		
	}
}
